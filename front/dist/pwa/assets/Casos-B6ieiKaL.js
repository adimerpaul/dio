import{_ as h,c as m,o as n,w as c,b as e,a as r,al as _,$ as p,f as g,d as f,a0 as i,a1 as x,a2 as y,t as a,Z as u}from"./index-DXNn1VH5.js";import{Q as b}from"./QSelect-C2d-2T6V.js";import{Q as C}from"./QBadge-3dQPnBZ1.js";import{Q as k}from"./QSpinnerDots-CZwtwKbz.js";import{Q as V}from"./QMarkupTable-OzONLx0a.js";import{Q}from"./QPagination-CT68p1Hk.js";import{Q as v}from"./QPage-BSldBvil.js";import"./format-D1ELUY7D.js";const w={name:"CasosPage",data(){return{casos:[],loading:!1,page:1,perPage:10,meta:{current_page:1,last_page:1,total:0,from:0,to:0},search:"",_searchTimer:null}},mounted(){this.fetchCasos()},methods:{fetchCasos(){this.loading=!0,this.$axios.get("casos",{params:{q:this.search||"",page:this.page,per_page:this.perPage}}).then(l=>{const t=l.data||{};this.casos=t.data||[],this.meta={current_page:t.current_page||1,last_page:t.last_page||1,total:t.total||0,from:t.from||0,to:t.to||0},this.page=this.meta.current_page}).catch(l=>this.$alert.error(l.response?.data?.message||"Error cargando casos")).finally(()=>{this.loading=!1})},onSearch(){this.page=1,this.fetchCasos()},clearSearch(){this.search="",this.onSearch()},goFirstPage(){this.page=1,this.fetchCasos()},rowIndex(l){return(this.meta.from||0)+l}}},P={class:"row items-center q-col-gutter-md q-mb-md"},S={class:"col-12 col-md"},q={class:"col-auto"},B={class:"col-auto"},I={key:0},N=["onClick"],U={class:"text-no-wrap"},T={class:"text-no-wrap"},z={class:"text-weight-medium"},D={key:0,class:"text-caption text-grey-7"},F={class:"text-weight-medium"},A={key:0,class:"text-caption text-grey-7"},E={key:1},M={key:2},Z={colspan:"8",class:"text-center"},j={class:"row items-center justify-between q-mt-md"},L={class:"text-caption text-grey-7"};function R(l,t,G,H,s,d){return n(),m(v,{class:"q-pa-md"},{default:c(()=>[e("div",P,[e("div",S,[r(_,{modelValue:s.search,"onUpdate:modelValue":[t[0]||(t[0]=o=>s.search=o),d.onSearch],outlined:"",dense:"",debounce:"400",placeholder:"Buscar por N° de caso, denunciante, denunciado, tipología, zona…"},{prepend:c(()=>[r(f,{name:"search"})]),append:c(()=>[s.search?(n(),m(g,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:d.clearSearch},null,8,["onClick"])):p("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"])]),e("div",q,[r(b,{modelValue:s.perPage,"onUpdate:modelValue":[t[1]||(t[1]=o=>s.perPage=o),d.goFirstPage],options:[10,20,50],dense:"",outlined:"",style:{width:"120px"},label:"Por página"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",B,[r(g,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",onClick:t[2]||(t[2]=o=>d.fetchCasos()),loading:s.loading},null,8,["loading"])])]),r(V,{flat:"",bordered:"",dense:""},{default:c(()=>[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",{style:{width:"60px"}},"#"),e("th",null,"Nº Caso"),e("th",null,"Fecha"),e("th",null,"Denunciante"),e("th",null,"Denunciado"),e("th",null,"Tipología"),e("th",null,"Zona"),e("th",null,"Tipo")])],-1)),!s.loading&&s.casos.length?(n(),i("tbody",I,[(n(!0),i(x,null,y(s.casos,(o,J)=>(n(),i("tr",{key:o.id,onClick:K=>l.$router.push("/casos/"+o.id),class:"cursor-pointer"},[e("td",null,a(o.id),1),e("td",U,a(o.caso_numero||"—"),1),e("td",T,a(l.$filters.date(o.fecha_apertura_caso)),1),e("td",null,[e("div",z,a(o.denunciante_nombre_completo),1),o.denunciante_nro?(n(),i("div",D,"CI: "+a(o.denunciante_nro),1)):p("",!0)]),e("td",null,[e("div",F,a(o.denunciado_nombre_completo||"—"),1),o.denunciado_nro?(n(),i("div",A,"CI: "+a(o.denunciado_nro),1)):p("",!0)]),e("td",null,a(o.caso_tipologia||"—"),1),e("td",null,a(o.zona||"—"),1),e("td",null,[r(C,{color:o.numero_apoyo_integral?"green":"grey-5","text-color":o.numero_apoyo_integral?"white":"black",label:o.numero_apoyo_integral?"Apoyo Integral":"Regular",rounded:"",dense:""},null,8,["color","text-color","label"])])],8,N))),128))])):!s.loading&&!s.casos.length?(n(),i("tbody",E,t[4]||(t[4]=[e("tr",null,[e("td",{colspan:"8",class:"text-center text-grey"}," No hay resultados para tu búsqueda. ")],-1)]))):(n(),i("tbody",M,[e("tr",null,[e("td",Z,[r(k,{size:"24px",class:"q-mr-sm"}),t[5]||(t[5]=u(" Cargando… "))])])]))]),_:1}),e("div",j,[e("div",L,[t[7]||(t[7]=u(" Mostrando ")),e("b",null,a(s.meta.from||0),1),t[8]||(t[8]=u(" – ")),e("b",null,a(s.meta.to||0),1),t[9]||(t[9]=u(" de ")),e("b",null,a(s.meta.total||0),1),t[10]||(t[10]=u(" registros "))]),r(Q,{modelValue:s.page,"onUpdate:modelValue":[t[3]||(t[3]=o=>s.page=o),d.fetchCasos],max:s.meta.last_page||1,"max-pages":"10","boundary-numbers":"","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])]),_:1})}const se=h(w,[["render",R],["__scopeId","data-v-7155f023"]]);export{se as default};
