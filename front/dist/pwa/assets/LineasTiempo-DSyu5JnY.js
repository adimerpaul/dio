import{_ as g,c as p,o as n,w as c,b as e,a as r,al as f,a0 as h,f as u,d as x,$ as i,a1 as y,a2 as w,t as a,Z as m}from"./index-DiQkYBn1.js";import{Q as b}from"./QSelect-DOVeCjN1.js";import{Q as k}from"./QSpinnerDots-DbqXAi-P.js";import{Q as v}from"./QMarkupTable-CdA_a4Wa.js";import{Q as V}from"./QPagination-CerIzJ4K.js";import{Q}from"./QPage-DgVCEu-b.js";import"./format-si0q-PyI.js";const P={name:"LineasTiempo",data(){return{loading:!1,search:"",page:1,perPage:10,rows:{data:[],total:0,last_page:1,from:0,to:0}}},mounted(){this.fetchRows()},methods:{async fetchRows(){this.loading=!0;try{const l=await this.$axios.get("/casos-linea-tiempo",{params:{q:this.search||"",page:this.page,per_page:this.perPage}});this.rows=l.data||{data:[],total:0,last_page:1,from:0,to:0},this.rows.current_page&&(this.page=this.rows.current_page)}catch(l){this.$q.notify({type:"negative",message:l?.response?.data?.message||"Error cargando datos"})}finally{this.loading=!1}},onSearch(){this.page=1,this.fetchRows()},clearSearch(){this.search="",this.onSearch()},goFirstPage(){this.page=1,this.fetchRows()},rowIndex(l){return(this.rows.from||0)+l}}},C={class:"row items-center q-col-gutter-md q-mb-md"},S={class:"col-12 col-md"},q={class:"col-auto"},B={class:"col-auto"},I={key:0},N=["onClick"],R={class:"text-no-wrap"},U={class:"text-weight-medium"},T={key:0,class:"text-caption text-grey-7"},z={class:"text-no-wrap"},D={key:0},F={class:"text-caption text-grey-7"},L={key:1,class:"text-grey"},E={key:0},M={class:"text-caption text-grey-7"},Z={key:1,class:"text-grey"},j={key:0},A={class:"text-caption text-grey-7"},G={key:1,class:"text-grey"},H={class:"text-no-wrap"},J={class:"text-no-wrap"},K={key:1},O={key:2},W={colspan:"8",class:"text-center"},X={class:"row items-center justify-between q-mt-md"},Y={class:"text-caption text-grey-7"};function $(l,s,ee,te,o,d){return n(),p(Q,{class:"q-pa-md"},{default:c(()=>[e("div",C,[e("div",S,[r(f,{modelValue:o.search,"onUpdate:modelValue":[s[0]||(s[0]=t=>o.search=t),d.onSearch],outlined:"",dense:"",debounce:"400",placeholder:"Buscar por N° de caso, denunciante, denunciado, tipología, zona…"},{prepend:c(()=>[r(x,{name:"search"})]),append:c(()=>[o.search?(n(),p(u,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:d.clearSearch},null,8,["onClick"])):h("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"])]),e("div",q,[r(b,{modelValue:o.perPage,"onUpdate:modelValue":[s[1]||(s[1]=t=>o.perPage=t),d.goFirstPage],options:[10,20,50],dense:"",outlined:"",style:{width:"120px"},label:"Por página"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",B,[r(u,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",loading:o.loading,onClick:d.fetchRows},null,8,["loading","onClick"])])]),r(v,{flat:"",bordered:"",dense:"",class:"table--wrap"},{default:c(()=>[s[5]||(s[5]=e("thead",null,[e("tr",null,[e("th",{style:{width:"60px"}},"#"),e("th",{style:{"min-width":"110px"}},"Nº Caso"),e("th",{style:{"min-width":"110px"}},"Denunciante"),e("th",{style:{"min-width":"130px"}},"Base (creación)"),e("th",{style:{"min-width":"220px"}},"Primera problemática"),e("th",{style:{"min-width":"220px"}},"Primera sesión psicológica"),e("th",{style:{"min-width":"220px"}},"Primer informe"),e("th",{style:{"min-width":"120px"}},"Tipología"),e("th",{style:{"min-width":"120px"}},"Zona")])],-1)),!o.loading&&o.rows.data.length?(n(),i("tbody",I,[(n(!0),i(y,null,w(o.rows.data,(t,_)=>(n(),i("tr",{key:t.id,onClick:se=>l.$router.push("/casos/"+t.id),class:"cursor-pointer"},[e("td",null,a(d.rowIndex(_)),1),e("td",R,a(t.caso_numero||"—"),1),e("td",null,[e("div",U,a(t.denunciante_nombre||"—"),1),t.denunciante_nro?(n(),i("div",T,"CI: "+a(t.denunciante_nro),1)):h("",!0)]),e("td",z,a(t.base||"—"),1),e("td",null,[t.first_problematica?.exists?(n(),i("div",D,[e("b",null,a(t.first_problematica.diff_human),1),e("div",F,"("+a(t.first_problematica.date_human)+")",1)])):(n(),i("div",L,"—"))]),e("td",null,[t.first_sesion?.exists?(n(),i("div",E,[e("b",null,a(t.first_sesion.diff_human),1),e("div",M,"("+a(t.first_sesion.date_human)+")",1)])):(n(),i("div",Z,"—"))]),e("td",null,[t.first_informe?.exists?(n(),i("div",j,[e("b",null,a(t.first_informe.diff_human),1),e("div",A,"("+a(t.first_informe.date_human)+")",1)])):(n(),i("div",G,"—"))]),e("td",H,a(t.caso_tipologia||"—"),1),e("td",J,a(t.caso_zona||"—"),1)],8,N))),128))])):!o.loading&&!o.rows.data.length?(n(),i("tbody",K,s[3]||(s[3]=[e("tr",null,[e("td",{colspan:"8",class:"text-center text-grey"},"Sin resultados")],-1)]))):(n(),i("tbody",O,[e("tr",null,[e("td",W,[r(k,{size:"24px",class:"q-mr-sm"}),s[4]||(s[4]=m(" Cargando…"))])])]))]),_:1}),e("div",X,[e("div",Y,[s[6]||(s[6]=m(" Mostrando ")),e("b",null,a(o.rows.from||0),1),s[7]||(s[7]=m(" – ")),e("b",null,a(o.rows.to||0),1),s[8]||(s[8]=m(" de ")),e("b",null,a(o.rows.total||0),1)]),r(V,{modelValue:o.page,"onUpdate:modelValue":[s[2]||(s[2]=t=>o.page=t),d.fetchRows],max:o.rows.last_page||1,"max-pages":"10","boundary-numbers":"","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])]),_:1})}const ce=g(P,[["render",$],["__scopeId","data-v-dbba7984"]]);export{ce as default};
