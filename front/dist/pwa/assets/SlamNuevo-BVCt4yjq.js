import{_ as k,Y as A,c as w,o as r,w as m,b as a,a as e,f as _,a9 as M,Q as f,e as V,d as h,a3 as g,a0 as p,$ as U,a6 as t,a7 as c,a1 as y,a2 as q}from"./index-DpunrW0G.js";import{Q as x}from"./QSpace-BEkj4cUf.js";import{Q as N}from"./QForm-VuY19NzC.js";import{Q as j}from"./QPage-2HawpGZ7.js";import{M as Q}from"./MapPicker-R1lUUj17.js";const F={name:"SlamNuevoDynamic",components:{MapPicker:Q},props:{showNumeroApoyoIntegral:{type:Boolean,default:!1}},data(){return{loading:!1,defaultCenter:[-17.9667,-67.1167],slam:{numero_apoyo_integral:"",numero_caso:"",am_latitud:null,am_longitud:null,am_idioma_castellano:!1,am_idioma_quechua:!1,am_idioma_aymara:!1,am_idioma_otros:"",ref_tel_fijo:"",ref_tel_movil:"",ref_tel_movil_alt:"",hecho_descripcion:"",tip_violencia_fisica:!1,tip_violencia_psicologica:!1,tip_abandono:!1,tip_apoyo_integral:!1,seg_trabajo_legal:!1,seg_trabajo_social:!1,seg_psicologico:!1,psicologica_user_id:null,trabajo_social_user_id:null,legal_user_id:null},adultos:[],familiares:[]}},computed:{mapModel:{get(){return{latitud:this.slam.am_latitud,longitud:this.slam.am_longitud}},set(i){this.slam.am_latitud=i?.latitud??i?.lat??null,this.slam.am_longitud=i?.longitud??i?.lng??null}}},methods:{req(i){return!!i||"Requerido"},addAdulto(){this.adultos.push({nombre:"",paterno:"",materno:"",documento_tipo:"",documento_num:"",fecha_nacimiento:"",lugar_nacimiento:"",edad:"",domicilio:"",estado_civil:"",ocupacion_1:"",ocupacion_2:"",ingresos:""})},removeAdulto(i){this.adultos.splice(i,1)},addFamiliar(){this.familiares.push({nombre:"",paterno:"",materno:"",parentesco:"",edad:null,sexo:"",telefono:""})},removeFamiliar(i){this.familiares.splice(i,1)},resetForm(){const i=["am_idioma_castellano","am_idioma_quechua","am_idioma_aymara","tip_violencia_fisica","tip_violencia_psicologica","tip_abandono","tip_apoyo_integral","seg_trabajo_legal","seg_trabajo_social","seg_psicologico"];Object.keys(this.slam).forEach(o=>{i.includes(o)?this.slam[o]=!1:o.includes("lat")||o.includes("long")?this.slam[o]=null:this.slam[o]=""}),this.slam.psicologica_user_id=this.slam.trabajo_social_user_id=this.slam.legal_user_id=null,this.adultos=[],this.familiares=[]},async save(){const i=this.adultos[0];if(!i||!i.nombre){this.$q.notify({type:"negative",message:"Debe agregar al menos un Adulto con nombres."});return}const o=this.adultos.filter(u=>u&&u.nombre?.trim()?.length),v=this.familiares.filter(u=>u&&u.nombre?.trim()?.length);this.loading=!0;try{const u={slam:this.slam,adultos:o,familiares:v},{data:s}=await this.$axios.post("/slams",u);this.$q.notify({type:"positive",message:"SLAM creado"}),this.$router.push(`/slams/${s.slam.id}`),this.resetForm()}catch(u){this.$q.notify({type:"negative",message:u?.response?.data?.message||"No se pudo crear el SLAM"})}finally{this.loading=!1}}}},S={class:"toolbar q-pa-sm bg-white row items-center q-gutter-sm shadow-1"},L={class:"col-auto row q-gutter-sm"},T={class:"row q-col-gutter-md"},I={key:0,class:"col-12 col-md-3"},P={class:"col-12 col-md-3"},B={class:"col-6 col-md-2"},D={class:"col-6 col-md-2"},E={class:"col-6 col-md-2"},O={class:"col-12 col-md-6"},R={class:"col-12 col-md-4"},G={class:"col-12 col-md-4"},z={class:"col-12 col-md-4"},H={class:"col-12"},Y={class:"col-6 col-md-3"},J={class:"col-6 col-md-3"},K={class:"col-12"},W={class:"col-6 col-md-3"},X={class:"col-6 col-md-3"},Z={class:"col-6 col-md-3"},$={class:"col-6 col-md-3"},ll={class:"col-6 col-md-3"},el={class:"col-6 col-md-3"},ol={class:"col-6 col-md-3"},al={key:0,class:"text-grey-7 q-mb-md"},sl={class:"row q-col-gutter-md items-center"},dl={class:"col-12 col-md-4"},tl={class:"col-6 col-md-2"},il={class:"col-6 col-md-2"},nl={class:"col-6 col-md-2"},ml={class:"col-6 col-md-2"},ul={class:"col-6 col-md-3"},cl={class:"col-6 col-md-3"},rl={class:"col-6 col-md-2"},_l={class:"col-12 col-md-4"},pl={class:"col-6 col-md-3"},Vl={class:"col-6 col-md-3"},bl={class:"col-6 col-md-3"},gl={class:"col-12 col-md-3"},vl={class:"col-auto q-mt-sm"},fl={key:0,class:"text-grey-7 q-mb-md"},hl={class:"row q-col-gutter-md items-center"},Ul={class:"col-12 col-md-4"},yl={class:"col-6 col-md-2"},ql={class:"col-6 col-md-2"},xl={class:"col-6 col-md-2"},Cl={class:"col-3 col-md-1"},kl={class:"col-3 col-md-1"},Al={class:"col-12 col-md-2"},wl={class:"col-auto q-mt-sm"},Ml={class:"text-right q-mb-xl"};function Nl(i,o,v,u,s,n){const C=A("MapPicker");return r(),w(j,{class:"q-pa-md bg-grey-2"},{default:m(()=>[a("div",S,[o[20]||(o[20]=a("div",{class:"col"},[a("div",{class:"text-h6 text-weight-bold"},"Nuevo S.L.A.M."),a("div",{class:"text-caption text-grey-7"},"Registro con múltiples Adultos y Familiares")],-1)),a("div",L,[e(_,{flat:"",color:"primary",icon:"history",label:"Limpiar",onClick:n.resetForm},null,8,["onClick"]),e(_,{color:"primary",icon:"save",label:"Guardar",loading:s.loading,onClick:n.save},null,8,["loading","onClick"])])]),e(N,{class:"q-mt-lg",onSubmit:M(n.save,["prevent"])},{default:m(()=>[e(f,{flat:"",bordered:"",class:"section-card"},{default:m(()=>[e(V,{class:"row items-center"},{default:m(()=>[e(h,{name:"description",class:"q-mr-sm"}),o[21]||(o[21]=a("div",{class:"text-subtitle1 text-weight-medium"},"1) Datos del caso (S.L.A.M.)",-1))]),_:1}),e(g),e(V,null,{default:m(()=>[a("div",T,[v.showNumeroApoyoIntegral?(r(),p("div",I,[e(t,{modelValue:s.slam.numero_apoyo_integral,"onUpdate:modelValue":o[0]||(o[0]=l=>s.slam.numero_apoyo_integral=l),dense:"",outlined:"",clearable:"",label:"Nº Apoyo Integral",hint:"Requerido si aplica"},null,8,["modelValue"])])):U("",!0),a("div",P,[e(t,{modelValue:s.slam.numero_caso,"onUpdate:modelValue":o[1]||(o[1]=l=>s.slam.numero_caso=l),dense:"",outlined:"",clearable:"",label:"Nº de caso"},null,8,["modelValue"])]),o[22]||(o[22]=a("div",{class:"col-12 text-subtitle2 q-mt-md"},"Idiomas (AM - marcadores generales)",-1)),a("div",B,[e(c,{modelValue:s.slam.am_idioma_castellano,"onUpdate:modelValue":o[2]||(o[2]=l=>s.slam.am_idioma_castellano=l),label:"Castellano"},null,8,["modelValue"])]),a("div",D,[e(c,{modelValue:s.slam.am_idioma_quechua,"onUpdate:modelValue":o[3]||(o[3]=l=>s.slam.am_idioma_quechua=l),label:"Quechua"},null,8,["modelValue"])]),a("div",E,[e(c,{modelValue:s.slam.am_idioma_aymara,"onUpdate:modelValue":o[4]||(o[4]=l=>s.slam.am_idioma_aymara=l),label:"Aymara"},null,8,["modelValue"])]),a("div",O,[e(t,{modelValue:s.slam.am_idioma_otros,"onUpdate:modelValue":o[5]||(o[5]=l=>s.slam.am_idioma_otros=l),dense:"",outlined:"",clearable:"",label:"Otros idiomas"},null,8,["modelValue"])]),o[23]||(o[23]=a("div",{class:"col-12 text-subtitle2 q-mt-sm"},"Teléfonos de referencia",-1)),a("div",R,[e(t,{modelValue:s.slam.ref_tel_fijo,"onUpdate:modelValue":o[6]||(o[6]=l=>s.slam.ref_tel_fijo=l),dense:"",outlined:"",label:"Tel. fijo"},null,8,["modelValue"])]),a("div",G,[e(t,{modelValue:s.slam.ref_tel_movil,"onUpdate:modelValue":o[7]||(o[7]=l=>s.slam.ref_tel_movil=l),dense:"",outlined:"",label:"Tel. móvil"},null,8,["modelValue"])]),a("div",z,[e(t,{modelValue:s.slam.ref_tel_movil_alt,"onUpdate:modelValue":o[8]||(o[8]=l=>s.slam.ref_tel_movil_alt=l),dense:"",outlined:"",label:"Tel. móvil (alt)"},null,8,["modelValue"])]),o[24]||(o[24]=a("div",{class:"col-12 text-subtitle2 q-mt-sm"},"Ubicación (lat/lng)",-1)),a("div",H,[e(C,{modelValue:n.mapModel,"onUpdate:modelValue":o[9]||(o[9]=l=>n.mapModel=l),center:s.defaultCenter,"zoom-init":13},null,8,["modelValue","center"])]),a("div",Y,[e(t,{modelValue:s.slam.am_latitud,"onUpdate:modelValue":o[10]||(o[10]=l=>s.slam.am_latitud=l),modelModifiers:{number:!0},dense:"",outlined:"",label:"Latitud"},null,8,["modelValue"])]),a("div",J,[e(t,{modelValue:s.slam.am_longitud,"onUpdate:modelValue":o[11]||(o[11]=l=>s.slam.am_longitud=l),modelModifiers:{number:!0},dense:"",outlined:"",label:"Longitud"},null,8,["modelValue"])]),o[25]||(o[25]=a("div",{class:"col-12 text-subtitle2 q-mt-sm"},"Hecho y Tipología",-1)),a("div",K,[e(t,{modelValue:s.slam.hecho_descripcion,"onUpdate:modelValue":o[12]||(o[12]=l=>s.slam.hecho_descripcion=l),type:"textarea",autogrow:"",outlined:"",dense:"",clearable:"",label:"Breve circunstancia del hecho / denuncia",maxlength:"3000"},null,8,["modelValue"])]),a("div",W,[e(c,{modelValue:s.slam.tip_violencia_fisica,"onUpdate:modelValue":o[13]||(o[13]=l=>s.slam.tip_violencia_fisica=l),label:"Violencia física"},null,8,["modelValue"])]),a("div",X,[e(c,{modelValue:s.slam.tip_violencia_psicologica,"onUpdate:modelValue":o[14]||(o[14]=l=>s.slam.tip_violencia_psicologica=l),label:"Violencia psicológica"},null,8,["modelValue"])]),a("div",Z,[e(c,{modelValue:s.slam.tip_abandono,"onUpdate:modelValue":o[15]||(o[15]=l=>s.slam.tip_abandono=l),label:"Abandono"},null,8,["modelValue"])]),a("div",$,[e(c,{modelValue:s.slam.tip_apoyo_integral,"onUpdate:modelValue":o[16]||(o[16]=l=>s.slam.tip_apoyo_integral=l),label:"Apoyo integral"},null,8,["modelValue"])]),a("div",ll,[e(c,{modelValue:s.slam.seg_trabajo_legal,"onUpdate:modelValue":o[17]||(o[17]=l=>s.slam.seg_trabajo_legal=l),label:"Trabajo legal"},null,8,["modelValue"])]),a("div",el,[e(c,{modelValue:s.slam.seg_trabajo_social,"onUpdate:modelValue":o[18]||(o[18]=l=>s.slam.seg_trabajo_social=l),label:"Trabajo social"},null,8,["modelValue"])]),a("div",ol,[e(c,{modelValue:s.slam.seg_psicologico,"onUpdate:modelValue":o[19]||(o[19]=l=>s.slam.seg_psicologico=l),label:"Psicológico"},null,8,["modelValue"])])])]),_:1})]),_:1}),e(f,{flat:"",bordered:"",class:"section-card"},{default:m(()=>[e(V,{class:"row items-center"},{default:m(()=>[e(h,{name:"elderly",class:"q-mr-sm"}),o[26]||(o[26]=a("div",{class:"text-subtitle1 text-weight-medium"},"2) Adultos (N)",-1)),e(x),e(_,{dense:"",color:"primary",flat:"",icon:"add",label:"Agregar adulto",onClick:n.addAdulto},null,8,["onClick"])]),_:1}),e(g),e(V,null,{default:m(()=>[s.adultos.length===0?(r(),p("div",al," No hay adultos agregados. Usa “Agregar adulto”. ")):U("",!0),(r(!0),p(y,null,q(s.adultos,(l,b)=>(r(),p("div",{key:b,class:"q-mb-md"},[a("div",sl,[a("div",dl,[e(t,{modelValue:l.nombre,"onUpdate:modelValue":d=>l.nombre=d,dense:"",outlined:"",clearable:"",rules:[n.req],label:"Nombres *"},null,8,["modelValue","onUpdate:modelValue","rules"])]),a("div",tl,[e(t,{modelValue:l.paterno,"onUpdate:modelValue":d=>l.paterno=d,dense:"",outlined:"",clearable:"",label:"Paterno"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",il,[e(t,{modelValue:l.materno,"onUpdate:modelValue":d=>l.materno=d,dense:"",outlined:"",clearable:"",label:"Materno"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",nl,[e(t,{modelValue:l.documento_tipo,"onUpdate:modelValue":d=>l.documento_tipo=d,dense:"",outlined:"",clearable:"",label:"Doc. tipo"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",ml,[e(t,{modelValue:l.documento_num,"onUpdate:modelValue":d=>l.documento_num=d,dense:"",outlined:"",clearable:"",label:"Doc. Nº"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",ul,[e(t,{modelValue:l.fecha_nacimiento,"onUpdate:modelValue":d=>l.fecha_nacimiento=d,type:"date",dense:"",outlined:"",label:"Fecha nac."},null,8,["modelValue","onUpdate:modelValue"])]),a("div",cl,[e(t,{modelValue:l.lugar_nacimiento,"onUpdate:modelValue":d=>l.lugar_nacimiento=d,dense:"",outlined:"",clearable:"",label:"Lugar nac."},null,8,["modelValue","onUpdate:modelValue"])]),a("div",rl,[e(t,{modelValue:l.edad,"onUpdate:modelValue":d=>l.edad=d,dense:"",outlined:"",clearable:"",label:"Edad"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",_l,[e(t,{modelValue:l.domicilio,"onUpdate:modelValue":d=>l.domicilio=d,dense:"",outlined:"",clearable:"",label:"Domicilio"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",pl,[e(t,{modelValue:l.estado_civil,"onUpdate:modelValue":d=>l.estado_civil=d,dense:"",outlined:"",clearable:"",label:"Estado civil"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",Vl,[e(t,{modelValue:l.ocupacion_1,"onUpdate:modelValue":d=>l.ocupacion_1=d,dense:"",outlined:"",clearable:"",label:"Ocupación 1"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",bl,[e(t,{modelValue:l.ocupacion_2,"onUpdate:modelValue":d=>l.ocupacion_2=d,dense:"",outlined:"",clearable:"",label:"Ocupación 2"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",gl,[e(t,{modelValue:l.ingresos,"onUpdate:modelValue":d=>l.ingresos=d,dense:"",outlined:"",clearable:"",label:"Ingresos"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",vl,[e(_,{dense:"",round:"",flat:"",color:"negative",icon:"delete",onClick:d=>n.removeAdulto(b)},null,8,["onClick"])])]),e(g,{spaced:""})]))),128))]),_:1})]),_:1}),e(f,{flat:"",bordered:"",class:"section-card"},{default:m(()=>[e(V,{class:"row items-center"},{default:m(()=>[e(h,{name:"diversity_3",class:"q-mr-sm"}),o[27]||(o[27]=a("div",{class:"text-subtitle1 text-weight-medium"},"3) Familiares (N)",-1)),e(x),e(_,{dense:"",color:"primary",flat:"",icon:"add",label:"Agregar familiar",onClick:n.addFamiliar},null,8,["onClick"])]),_:1}),e(g),e(V,null,{default:m(()=>[s.familiares.length===0?(r(),p("div",fl," No hay familiares agregados. Usa “Agregar familiar”. ")):U("",!0),(r(!0),p(y,null,q(s.familiares,(l,b)=>(r(),p("div",{key:b,class:"q-mb-md"},[a("div",hl,[a("div",Ul,[e(t,{modelValue:l.nombre,"onUpdate:modelValue":d=>l.nombre=d,dense:"",outlined:"",clearable:"",label:"Nombres *"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",yl,[e(t,{modelValue:l.paterno,"onUpdate:modelValue":d=>l.paterno=d,dense:"",outlined:"",clearable:"",label:"Paterno"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",ql,[e(t,{modelValue:l.materno,"onUpdate:modelValue":d=>l.materno=d,dense:"",outlined:"",clearable:"",label:"Materno"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",xl,[e(t,{modelValue:l.parentesco,"onUpdate:modelValue":d=>l.parentesco=d,dense:"",outlined:"",clearable:"",label:"Parentesco"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",Cl,[e(t,{modelValue:l.edad,"onUpdate:modelValue":d=>l.edad=d,modelModifiers:{number:!0},type:"number",dense:"",outlined:"",label:"Edad"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",kl,[e(t,{modelValue:l.sexo,"onUpdate:modelValue":d=>l.sexo=d,dense:"",outlined:"",clearable:"",label:"Sexo"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",Al,[e(t,{modelValue:l.telefono,"onUpdate:modelValue":d=>l.telefono=d,dense:"",outlined:"",clearable:"",label:"Teléfono"},null,8,["modelValue","onUpdate:modelValue"])]),a("div",wl,[e(_,{dense:"",round:"",flat:"",color:"negative",icon:"delete",onClick:d=>n.removeFamiliar(b)},null,8,["onClick"])])]),e(g,{spaced:""})]))),128))]),_:1})]),_:1}),a("div",Ml,[e(_,{flat:"",color:"primary",icon:"history",label:"Limpiar",onClick:n.resetForm,class:"q-mr-sm"},null,8,["onClick"]),e(_,{color:"primary",icon:"save",label:"Guardar",loading:s.loading,onClick:n.save},null,8,["loading","onClick"])])]),_:1},8,["onSubmit"])]),_:1})}const Tl=k(F,[["render",Nl],["__scopeId","data-v-4f56e592"]]);export{Tl as S};
