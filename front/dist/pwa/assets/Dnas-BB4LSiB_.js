import{_ as f,c as g,o as l,w as c,b as e,a as r,a6 as b,$ as m,f as h,d as x,a0 as d,a1 as y,a2 as k,t as s,Z as u}from"./index-6VkIjhqe.js";import{Q as P}from"./QSelect-BJ7TsnOB.js";import{Q as p}from"./QBadge-Vvjy_Ys2.js";import{Q as C}from"./QSpinnerDots-C1Oajc4M.js";import{Q as V}from"./QMarkupTable-DOG7CcEn.js";import{Q}from"./QPagination-VQdNU7D5.js";import{Q as w}from"./QPage-DzTIvfIT.js";import"./format-C-AzdLyV.js";const D={name:"DnasPage",data(){return{dnas:[],loading:!1,page:1,perPage:10,meta:{current_page:1,last_page:1,total:0,from:0,to:0},search:""}},mounted(){this.fetchDnas()},methods:{tipoLabel(n){return{PROCESO_PENAL:"Procesos Penales",PROCESO_FAMILIAR:"Procesos Familiares",PROCESO_NNA:"Procesos Niñez y Adolescencia",APOYO_INTEGRAL:"Apoyos Integrales"}[(n||"").toUpperCase()]||n||"—"},fetchDnas(){this.loading=!0,this.$axios.get("/dnas",{params:{q:this.search||"",page:this.page,per_page:this.perPage}}).then(n=>{const t=n.data||{};this.dnas=t.data||[],this.meta={current_page:t.current_page||1,last_page:t.last_page||1,total:t.total||0,from:t.from||0,to:t.to||0},this.page=this.meta.current_page}).catch(n=>this.$alert?.error?.(n.response?.data?.message||"Error cargando DNAs")).finally(()=>{this.loading=!1})},onSearch(){this.page=1,this.fetchDnas()},clearSearch(){this.search="",this.onSearch()},goFirstPage(){this.page=1,this.fetchDnas()},rowIndex(n){return(this.meta.from||0)+n}}},v={class:"row items-center q-col-gutter-md q-mb-md"},S={class:"col-12 col-md"},A={class:"col-auto"},I={class:"col-auto"},N={key:0},q=["onClick"],F={class:"text-no-wrap"},O={class:"text-no-wrap"},B={class:"text-weight-medium"},E={key:0,class:"text-caption text-grey-7"},U={class:"text-weight-medium"},L={key:0,class:"text-caption text-grey-7"},z={key:0},M={key:1,class:"text-grey-6"},R={key:1},T={key:2},Z={colspan:"9",class:"text-center"},j={class:"row items-center justify-between q-mt-md"},G={class:"text-caption text-grey-7"};function Y(n,t,H,J,a,i){return l(),g(w,{class:"q-pa-md"},{default:c(()=>[e("div",v,[e("div",S,[r(b,{modelValue:a.search,"onUpdate:modelValue":[t[0]||(t[0]=o=>a.search=o),i.onSearch],outlined:"",dense:"",debounce:"400",placeholder:"Buscar por Código, denunciante, denunciado, tipo, zona…"},{prepend:c(()=>[r(x,{name:"search"})]),append:c(()=>[a.search?(l(),g(h,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:i.clearSearch},null,8,["onClick"])):m("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"])]),e("div",A,[r(P,{modelValue:a.perPage,"onUpdate:modelValue":[t[1]||(t[1]=o=>a.perPage=o),i.goFirstPage],options:[10,20,50],dense:"",outlined:"",style:{width:"120px"},label:"Por página"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",I,[r(h,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",onClick:t[2]||(t[2]=o=>i.fetchDnas()),loading:a.loading},null,8,["loading"])])]),r(V,{flat:"",bordered:"",dense:""},{default:c(()=>[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",{style:{width:"60px"}},"#"),e("th",null,"Código"),e("th",null,"Fecha"),e("th",null,"Denunciante"),e("th",null,"Denunciado"),e("th",null,"Tipo proceso"),e("th",null,"Zona"),e("th",null,"Abogado(a)"),e("th",null,"Men/Fam")])],-1)),!a.loading&&a.dnas.length?(l(),d("tbody",N,[(l(!0),d(y,null,k(a.dnas,(o,_)=>(l(),d("tr",{key:o.id,onClick:K=>n.$router.push("/dnas/"+o.id),class:"cursor-pointer"},[e("td",null,s(i.rowIndex(_)),1),e("td",F,s(o.codigo||"—"),1),e("td",O,s(n.$filters.date?.(o.fecha_atencion)||o.fecha_atencion||"—"),1),e("td",null,[e("div",B,s(o.denunciante_nombre||"—"),1),o.denunciante_ci?(l(),d("div",E,"CI: "+s(o.denunciante_ci),1)):m("",!0)]),e("td",null,[e("div",U,s(o.denunciado_nombre||"—"),1),o.denunciado_ci?(l(),d("div",L,"CI: "+s(o.denunciado_ci),1)):m("",!0)]),e("td",null,[r(p,{color:"blue-2","text-color":"blue-10",label:i.tipoLabel(o.tipo_proceso)},null,8,["label"])]),e("td",null,s(o.zona||"—"),1),e("td",null,[o.abogado?.name?(l(),d("span",z,s(o.abogado.name),1)):(l(),d("span",M,"Sin asignar"))]),e("td",null,[r(p,{color:"grey-3","text-color":"black",rounded:"",dense:"",class:"q-mr-xs"},{default:c(()=>[u(s(o.menores_count??0)+" M ",1)]),_:2},1024),r(p,{color:"grey-3","text-color":"black",rounded:"",dense:""},{default:c(()=>[u(s(o.familiares_count??0)+" F ",1)]),_:2},1024)])],8,q))),128))])):!a.loading&&!a.dnas.length?(l(),d("tbody",R,t[4]||(t[4]=[e("tr",null,[e("td",{colspan:"9",class:"text-center text-grey"}," No hay resultados para tu búsqueda. ")],-1)]))):(l(),d("tbody",T,[e("tr",null,[e("td",Z,[r(C,{size:"24px",class:"q-mr-sm"}),t[5]||(t[5]=u(" Cargando… "))])])]))]),_:1}),e("div",j,[e("div",G,[t[7]||(t[7]=u(" Mostrando ")),e("b",null,s(a.meta.from||0),1),t[8]||(t[8]=u(" – ")),e("b",null,s(a.meta.to||0),1),t[9]||(t[9]=u(" de ")),e("b",null,s(a.meta.total||0),1),t[10]||(t[10]=u(" registros "))]),r(Q,{modelValue:a.page,"onUpdate:modelValue":[t[3]||(t[3]=o=>a.page=o),i.fetchDnas],max:a.meta.last_page||1,"max-pages":"10","boundary-numbers":"","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])]),_:1})}const ne=f(D,[["render",Y],["__scopeId","data-v-00dc19f2"]]);export{ne as default};
