import{_ as f,c,o as r,w as u,b as e,a as i,a6 as y,$ as g,f as _,d as x,a0 as n,a1 as m,a2 as b,t as s,Z as l}from"./index-BTNOjq4i.js";import{Q as h}from"./QBadge-BGvbGx29.js";import{Q as k}from"./QTooltip-B7NuwCRa.js";import{Q as C}from"./QSpinnerDots-CPw3zz6n.js";import{Q as w}from"./QMarkupTable-DYdbtheg.js";import{Q}from"./QPagination-Ky43j0-J.js";import{Q as v}from"./QPage-DT6AMuOr.js";import"./format-Bvf4zQKP.js";const V={name:"CasosPage",data(){return{casos:[],loading:!1,page:1,perPage:10,meta:{current_page:1,last_page:1,total:0,from:0,to:0},search:"",_searchTimer:null}},mounted(){},methods:{fetchCasos(){if(this.search==="")return this.$alert.info("Ingresa un Nurej para buscar");this.loading=!0,this.$axios.get("search-nurej",{params:{nurej:this.search||""}}).then(d=>{this.casos=d.data||[]}).catch(d=>this.$alert.error(d.response?.data?.message||"Error cargando casos")).finally(()=>{this.loading=!1})},onSearch(){this.page=1,this.fetchCasos()},clearSearch(){this.search="",this.onSearch()},goFirstPage(){this.page=1,this.fetchCasos()},rowIndex(d){return(this.meta.from||0)+d}}},q={class:"row items-center q-col-gutter-md q-mb-md"},B={class:"col-12 col-md"},I={class:"col-auto"},N={key:0},j=["onClick"],P={class:"text-no-wrap"},S={class:"text-no-wrap"},T={class:"text-weight-medium"},D={key:0,class:"text-caption text-grey-7"},F={class:"text-weight-medium"},A={key:0,class:"text-caption text-grey-7"},U={key:1,class:"text-grey-6"},M={key:1},z={key:2},E={colspan:"8",class:"text-center"},Z={class:"row items-center justify-between q-mt-md"},L={class:"text-caption text-grey-7"};function R(d,t,G,H,a,p){return r(),c(v,{class:"q-pa-md"},{default:u(()=>[e("div",q,[e("div",B,[i(y,{modelValue:a.search,"onUpdate:modelValue":[t[0]||(t[0]=o=>a.search=o),p.onSearch],outlined:"",dense:"",debounce:"400",placeholder:"Buscar por Nurej"},{prepend:u(()=>[i(x,{name:"search"})]),append:u(()=>[a.search?(r(),c(_,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:p.clearSearch},null,8,["onClick"])):g("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"])]),t[3]||(t[3]=e("div",{class:"col-auto"},null,-1)),e("div",I,[i(_,{color:"primary",icon:"refresh",label:"Buscar","no-caps":"",onClick:t[1]||(t[1]=o=>p.fetchCasos()),loading:a.loading},null,8,["loading"])])]),i(w,{flat:"",bordered:"",dense:""},{default:u(()=>[t[11]||(t[11]=e("thead",null,[e("tr",null,[e("th",{style:{width:"60px"}},"#"),e("th",null,"Nº Caso"),e("th",null,"Fecha"),e("th",null,"Denunciante"),e("th",null,"Denunciado"),e("th",null,"Tipología"),e("th",null,"Zona"),e("th",null,"Tipo"),e("th",null,"Alerta")])],-1)),!a.loading&&a.casos.length?(r(),n("tbody",N,[(r(!0),n(m,null,b(a.casos,(o,J)=>(r(),n("tr",{key:o.id,onClick:K=>d.$router.push("/acogimiento/"+o.id),class:"cursor-pointer"},[e("td",null,s(o.id),1),e("td",P,s(o.caso_numero||"—"),1),e("td",S,s(d.$filters.date(o.fecha_apertura_caso)),1),e("td",null,[e("div",T,s(o.denunciante_nombre_completo),1),o.denunciante_nro?(r(),n("div",D,"CI: "+s(o.denunciante_nro),1)):g("",!0)]),e("td",null,[e("div",F,s(o.denunciado_nombre_completo||"—"),1),o.denunciado_nro?(r(),n("div",A,"CI: "+s(o.denunciado_nro),1)):g("",!0)]),e("td",null,s(o.caso_tipologia||"—"),1),e("td",null,s(o.zona||"—"),1),e("td",null,[i(h,{color:o.numero_apoyo_integral?"green":"grey-5","text-color":o.numero_apoyo_integral?"white":"black",label:o.numero_apoyo_integral?"Apoyo Integral":"Regular",rounded:"",dense:""},null,8,["color","text-color","label"])]),e("td",null,[o.mi_estado?.me_asignado?(r(),n(m,{key:0},[o.mi_estado.primer_informe_hecho?(r(),c(h,{key:0,color:"green","text-color":"white",class:"q-mr-xs"},{default:u(()=>[l(s(o.mi_estado.label_listo||"Primer informe listo"),1)]),_:2},1024)):(r(),n(m,{key:1},[i(h,{color:o.mi_estado.atrasado?"red":"orange","text-color":o.mi_estado.atrasado?"white":"black",class:"q-mr-xs"},{default:u(()=>[o.mi_estado.atrasado?(r(),n(m,{key:0},[l(" Atrasado "+s(Math.abs(o.mi_estado.dias_restantes))+" d ",1)],64)):(r(),n(m,{key:1},[l(" Faltan "+s(o.mi_estado.dias_restantes)+" d ",1)],64))]),_:2},1032,["color","text-color"]),i(k,{"transition-show":"jump-down","transition-hide":"jump-up"},{default:u(()=>[t[4]||(t[4]=l(" Debes cargar tu ")),e("b",null,s(o.mi_estado.rol==="Psicologo"?"primera sesión":"primer informe"),1),t[5]||(t[5]=l(".")),t[6]||(t[6]=e("br",null,null,-1)),t[7]||(t[7]=l(" Fecha límite: ")),e("b",null,s(o.mi_estado.deadline),1),t[8]||(t[8]=l(". "))]),_:2},1024)],64))],64)):(r(),n("span",U,"—"))])],8,j))),128))])):!a.loading&&!a.casos.length?(r(),n("tbody",M,t[9]||(t[9]=[e("tr",null,[e("td",{colspan:"8",class:"text-center text-grey"}," No hay resultados para tu búsqueda. ")],-1)]))):(r(),n("tbody",z,[e("tr",null,[e("td",E,[i(C,{size:"24px",class:"q-mr-sm"}),t[10]||(t[10]=l(" Cargando… "))])])]))]),_:1}),e("div",Z,[e("div",L,[t[12]||(t[12]=l(" Mostrando ")),e("b",null,s(a.meta.from||0),1),t[13]||(t[13]=l(" – ")),e("b",null,s(a.meta.to||0),1),t[14]||(t[14]=l(" de ")),e("b",null,s(a.meta.total||0),1),t[15]||(t[15]=l(" registros "))]),i(Q,{modelValue:a.page,"onUpdate:modelValue":[t[2]||(t[2]=o=>a.page=o),p.fetchCasos],max:a.meta.last_page||1,"max-pages":"10","boundary-numbers":"","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])]),_:1})}const se=f(V,[["render",R],["__scopeId","data-v-6a130a4a"]]);export{se as default};
