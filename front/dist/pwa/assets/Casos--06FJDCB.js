import{_,c as p,o as n,w as c,b as e,a as r,al as f,$ as m,f as g,d as x,a0 as d,a1 as y,a2 as b,t as a,Z as u}from"./index-B2ua84ly.js";import{Q as C}from"./QSelect-3zpNIzZx.js";import{Q as k}from"./QBadge-BwkONIjK.js";import{Q as V}from"./QSpinnerDots-my3IRULJ.js";import{Q}from"./QMarkupTable-BSWk2eI_.js";import{Q as w}from"./QPagination-gAlLEvPM.js";import{Q as v}from"./QPage-B3si9-Nl.js";import"./format-CtLJSdg-.js";const P={name:"CasosPage",data(){return{casos:[],loading:!1,page:1,perPage:10,meta:{current_page:1,last_page:1,total:0,from:0,to:0},search:"",_searchTimer:null}},mounted(){this.fetchCasos()},methods:{fetchCasos(){this.loading=!0,this.$axios.get("casos",{params:{q:this.search||"",page:this.page,per_page:this.perPage}}).then(l=>{const t=l.data||{};this.casos=t.data||[],this.meta={current_page:t.current_page||1,last_page:t.last_page||1,total:t.total||0,from:t.from||0,to:t.to||0},this.page=this.meta.current_page}).catch(l=>this.$alert.error(l.response?.data?.message||"Error cargando casos")).finally(()=>{this.loading=!1})},onSearch(){this.page=1,this.fetchCasos()},clearSearch(){this.search="",this.onSearch()},goFirstPage(){this.page=1,this.fetchCasos()},rowIndex(l){return(this.meta.from||0)+l}}},I={class:"row items-center q-col-gutter-md q-mb-md"},S={class:"col-12 col-md"},q={class:"col-auto"},B={class:"col-auto"},N={key:0},U=["onClick"],T={class:"text-no-wrap"},z={class:"text-no-wrap"},D={class:"text-weight-medium"},F={key:0,class:"text-caption text-grey-7"},A={class:"text-weight-medium"},E={key:0,class:"text-caption text-grey-7"},M={key:1},Z={key:2},j={colspan:"8",class:"text-center"},L={class:"row items-center justify-between q-mt-md"},R={class:"text-caption text-grey-7"};function G(l,t,H,J,s,i){return n(),p(v,{class:"q-pa-md"},{default:c(()=>[e("div",I,[e("div",S,[r(f,{modelValue:s.search,"onUpdate:modelValue":[t[0]||(t[0]=o=>s.search=o),i.onSearch],outlined:"",dense:"",debounce:"400",placeholder:"Buscar por N° de caso, denunciante, denunciado, tipología, zona…"},{prepend:c(()=>[r(x,{name:"search"})]),append:c(()=>[s.search?(n(),p(g,{key:0,flat:"",dense:"",round:"",icon:"close",onClick:i.clearSearch},null,8,["onClick"])):m("",!0)]),_:1},8,["modelValue","onUpdate:modelValue"])]),e("div",q,[r(C,{modelValue:s.perPage,"onUpdate:modelValue":[t[1]||(t[1]=o=>s.perPage=o),i.goFirstPage],options:[10,20,50],dense:"",outlined:"",style:{width:"120px"},label:"Por página"},null,8,["modelValue","onUpdate:modelValue"])]),e("div",B,[r(g,{color:"primary",icon:"refresh",label:"Actualizar","no-caps":"",onClick:t[2]||(t[2]=o=>i.fetchCasos()),loading:s.loading},null,8,["loading"])])]),r(Q,{flat:"",bordered:"",dense:""},{default:c(()=>[t[6]||(t[6]=e("thead",null,[e("tr",null,[e("th",{style:{width:"60px"}},"#"),e("th",null,"Nº Caso"),e("th",null,"Fecha"),e("th",null,"Denunciante"),e("th",null,"Denunciado"),e("th",null,"Tipología"),e("th",null,"Zona"),e("th",null,"Tipo")])],-1)),!s.loading&&s.casos.length?(n(),d("tbody",N,[(n(!0),d(y,null,b(s.casos,(o,h)=>(n(),d("tr",{key:o.id,onClick:K=>l.$router.push("/casos/"+o.id),class:"cursor-pointer"},[e("td",null,a(i.rowIndex(h)),1),e("td",T,a(o.caso_numero||"—"),1),e("td",z,a(l.$filters.date(o.fecha_apertura_caso)),1),e("td",null,[e("div",D,a(o.denunciante_nombre_completo),1),o.denunciante_nro?(n(),d("div",F,"CI: "+a(o.denunciante_nro),1)):m("",!0)]),e("td",null,[e("div",A,a(o.denunciado_nombre_completo||"—"),1),o.denunciado_nro?(n(),d("div",E,"CI: "+a(o.denunciado_nro),1)):m("",!0)]),e("td",null,a(o.caso_tipologia||"—"),1),e("td",null,a(o.zona||"—"),1),e("td",null,[r(k,{color:o.numero_apoyo_integral?"green":"grey-5","text-color":o.numero_apoyo_integral?"white":"black",label:o.numero_apoyo_integral?"Apoyo Integral":"Regular",rounded:"",dense:""},null,8,["color","text-color","label"])])],8,U))),128))])):!s.loading&&!s.casos.length?(n(),d("tbody",M,t[4]||(t[4]=[e("tr",null,[e("td",{colspan:"8",class:"text-center text-grey"}," No hay resultados para tu búsqueda. ")],-1)]))):(n(),d("tbody",Z,[e("tr",null,[e("td",j,[r(V,{size:"24px",class:"q-mr-sm"}),t[5]||(t[5]=u(" Cargando… "))])])]))]),_:1}),e("div",L,[e("div",R,[t[7]||(t[7]=u(" Mostrando ")),e("b",null,a(s.meta.from||0),1),t[8]||(t[8]=u(" – ")),e("b",null,a(s.meta.to||0),1),t[9]||(t[9]=u(" de ")),e("b",null,a(s.meta.total||0),1),t[10]||(t[10]=u(" registros "))]),r(w,{modelValue:s.page,"onUpdate:modelValue":[t[3]||(t[3]=o=>s.page=o),i.fetchCasos],max:s.meta.last_page||1,"max-pages":"10","boundary-numbers":"","direction-links":""},null,8,["modelValue","max","onUpdate:modelValue"])])]),_:1})}const se=_(P,[["render",G],["__scopeId","data-v-94d0c024"]]);export{se as default};
