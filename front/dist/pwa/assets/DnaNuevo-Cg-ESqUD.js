import{Q as h}from"./format-xuGwOK_p.js";import{_ as w,c as v,o as p,w as i,b as d,a as l,Z as x,t as A,f as m,a9 as k,Q as r,e as t,d as f,a3 as b,a6 as a,a0 as g,a1 as y,a2 as q,$ as C,a7 as U}from"./index-DpunrW0G.js";import{Q as V}from"./QSelect-EjbEQcH9.js";import{Q as N}from"./QExpansionItem-jpooRQxQ.js";import{Q as P}from"./QForm-VuY19NzC.js";import{Q as D}from"./QPage-2HawpGZ7.js";const j={name:"DnaNuevo",props:{tipoProceso:{type:String,required:!0}},data(){return{loading:!1,abogados:[],sexos:[{label:"Masculino",value:"Masculino"},{label:"Femenino",value:"Femenino"},{label:"Otro",value:"Otro"}],f:{tipo_proceso:this.tipoProceso,fecha_atencion:"",principal:"",codigo:"",zona:this.$store?.user?.zona||"",area:"DNA",domicilio:"",telefono:"",menores:[{nombre:"",gestante:!1,edad_anios:null,edad_meses:null,sexo:"",cert_nac:!1,estudia:!1,ultimo_curso:"",tipo_trabajo:""}],grupo_familiar:[],denunciado_nombre:"",denunciado_sexo:"",denunciado_edad:null,denunciado_relacion:"",denunciado_ci:"",denunciado_domicilio:"",denunciado_telefono:"",denunciado_lugar_trabajo:"",denunciado_ocupacion:"",denunciante_nombre:"",denunciante_sexo:"",denunciante_edad:null,denunciante_ci:"",denunciante_domicilio:"",denunciante_telefono:"",denunciante_lugar_trabajo:"",denunciante_ocupacion:"",descripcion:"",abogado_user_id:null}}},computed:{isApoyo(){return(this.tipoProceso||"").toUpperCase()==="APOYO_INTEGRAL"},tipoProcesoLabel(){return{PROCESO_PENAL:"Procesos Penales",PROCESO_FAMILIAR:"Procesos Familiares",PROCESO_NNA:"Procesos Niñez y Adolescencia",APOYO_INTEGRAL:"Apoyos Integrales"}[this.tipoProceso]||this.tipoProceso}},mounted(){this.$axios.get("/usuariosRole").then(c=>{this.abogados=c.data.abogados||[]}).catch(()=>{this.$alert?.error?.("No se pudo cargar abogados")})},methods:{req(c){return!!c||"Requerido"},addMenor(){this.f.menores.push({nombre:"",gestante:!1,edad_anios:null,edad_meses:null,sexo:"",cert_nac:!1,estudia:!1,ultimo_curso:"",tipo_trabajo:""})},addFam(){this.f.grupo_familiar.push({nombre:"",parentesco:"",edad:null,sexo:"",instruccion:"",ocupacion:""})},resetForm(){const c={tipo_proceso:this.tipoProceso,area:"DNA",zona:this.$store?.user?.zona||""};this.f={...c,fecha_atencion:"",principal:"",codigo:"",domicilio:"",telefono:"",menores:[{nombre:"",gestante:!1,edad_anios:null,edad_meses:null,sexo:"",cert_nac:!1,estudia:!1,ultimo_curso:"",tipo_trabajo:""}],grupo_familiar:[],denunciado_nombre:"",denunciado_sexo:"",denunciado_edad:null,denunciado_relacion:"",denunciado_ci:"",denunciado_domicilio:"",denunciado_telefono:"",denunciado_lugar_trabajo:"",denunciado_ocupacion:"",denunciante_nombre:"",denunciante_sexo:"",denunciante_edad:null,denunciante_ci:"",denunciante_domicilio:"",denunciante_telefono:"",denunciante_lugar_trabajo:"",denunciante_ocupacion:"",descripcion:"",abogado_user_id:null},this.$q.notify({type:"info",message:"Formulario reiniciado"})},async save(){if(!this.f.denunciante_nombre){this.$alert?.error?.("El nombre del denunciante es obligatorio");return}this.loading=!0;try{const{data:c}=await this.$axios.post("/dnas",this.f);this.$alert?.success?.("Caso DNA creado"),this.$router.push("/dnas")}catch(c){this.$alert?.error?.(c?.response?.data?.message||"No se pudo crear el caso DNA")}finally{this.loading=!1}}}},Q={class:"toolbar q-pa-sm bg-white row items-center q-gutter-sm shadow-1"},O={class:"col"},E={class:"text-caption text-grey-7"},F={class:"col-auto row q-gutter-sm"},S={class:"row q-col-gutter-md"},I={class:"col-12 col-md-3"},L={class:"col-12 col-md-3"},M={class:"col-12 col-md-3"},R={class:"col-12 col-md-3"},T={class:"col-12 col-md-8"},z={class:"col-12 col-md-4"},G={class:"q-mb-sm"},B={class:"col-12 col-md-4"},Y={class:"col-6 col-md-2"},Z={class:"col-6 col-md-2"},H={class:"col-6 col-md-2"},J={class:"col-6 col-md-2"},K={class:"col-6 col-md-2"},W={class:"col-6 col-md-2"},X={class:"col-6 col-md-3"},$={class:"col-6 col-md-3"},ee={class:"col-12 col-md-2"},le={class:"q-mb-sm"},oe={class:"col-12 col-md-4"},ne={class:"col-6 col-md-2"},de={class:"col-6 col-md-2"},ae={class:"col-6 col-md-2"},se={class:"col-6 col-md-2"},ie={class:"col-6 col-md-2"},te={class:"col-12 col-md-2"},ue={class:"row q-col-gutter-md"},ce={class:"col-12 col-md-6"},re={class:"col-6 col-md-2"},me={class:"col-6 col-md-2"},_e={class:"col-6 col-md-2"},pe={class:"col-6 col-md-2"},be={class:"col-12 col-md-6"},fe={class:"col-6 col-md-3"},Ve={class:"col-6 col-md-3"},ge={class:"col-6 col-md-3"},ve={class:"row q-col-gutter-md"},xe={class:"col-12 col-md-6"},Ue={class:"col-6 col-md-2"},he={class:"col-6 col-md-2"},ye={class:"col-6 col-md-2"},qe={class:"col-12 col-md-6"},Ce={class:"col-6 col-md-3"},Ne={class:"col-6 col-md-3"},we={class:"col-6 col-md-3"},Ae={class:"row q-col-gutter-md"},ke={class:"col-12 col-md-6"},Pe={class:"col-12 col-md-3"},De={class:"text-right q-mb-lg"};function je(c,o,Qe,Oe,n,u){return p(),v(D,{class:"q-pa-md bg-grey-2"},{default:i(()=>[d("div",Q,[d("div",O,[o[26]||(o[26]=d("div",{class:"text-h6 text-weight-bold"},"Nuevo caso DNA",-1)),d("div",E,[o[25]||(o[25]=x(" Registro de atención/denuncia · ")),l(h,{dense:"",color:"blue-1","text-color":"blue-9"},{default:i(()=>[x(A(u.tipoProcesoLabel),1)]),_:1})])]),d("div",F,[l(m,{flat:"",color:"primary",icon:"history",label:"Limpiar",onClick:u.resetForm},null,8,["onClick"]),l(m,{color:"primary",icon:"save",label:"Guardar",loading:n.loading,onClick:u.save},null,8,["loading","onClick"])])]),l(P,{class:"q-mt-lg",onSubmit:k(u.save,["prevent"])},{default:i(()=>[l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(t,{class:"row items-center"},{default:i(()=>[l(f,{name:"assignment",class:"q-mr-sm"}),o[27]||(o[27]=d("div",{class:"text-subtitle1 text-weight-medium"},"1) Datos generales",-1))]),_:1}),l(b),l(t,null,{default:i(()=>[d("div",S,[d("div",I,[l(a,{modelValue:n.f.fecha_atencion,"onUpdate:modelValue":o[0]||(o[0]=e=>n.f.fecha_atencion=e),type:"date",dense:"",outlined:"",label:"Fecha de atención"},null,8,["modelValue"])]),d("div",L,[l(a,{modelValue:n.f.principal,"onUpdate:modelValue":o[1]||(o[1]=e=>n.f.principal=e),dense:"",outlined:"",clearable:"",label:"Principal (ej. 'Asistencia Familiar')"},null,8,["modelValue"])]),d("div",M,[l(a,{modelValue:n.f.codigo,"onUpdate:modelValue":o[2]||(o[2]=e=>n.f.codigo=e),dense:"",outlined:"",clearable:"",label:u.isApoyo?"Nro. Apoyo Integral":"Código interno",hint:u.isApoyo?"Obligatorio si tu flujo lo requiere":"Opcional"},null,8,["modelValue","label","hint"])]),d("div",R,[l(a,{modelValue:n.f.zona,"onUpdate:modelValue":o[3]||(o[3]=e=>n.f.zona=e),dense:"",outlined:"",clearable:"",label:"Zona"},null,8,["modelValue"])]),d("div",T,[l(a,{modelValue:n.f.domicilio,"onUpdate:modelValue":o[4]||(o[4]=e=>n.f.domicilio=e),dense:"",outlined:"",clearable:"",label:"Domicilio"},null,8,["modelValue"])]),d("div",z,[l(a,{modelValue:n.f.telefono,"onUpdate:modelValue":o[5]||(o[5]=e=>n.f.telefono=e),dense:"",outlined:"",clearable:"",label:"Teléfono"},null,8,["modelValue"])])])]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(N,{icon:"child_care","dense-toggle":"","expand-separator":"",label:"2) Datos del/los menor(es)","header-class":"text-subtitle1"},{default:i(()=>[l(r,null,{default:i(()=>[l(t,null,{default:i(()=>[d("div",G,[l(m,{dense:"",icon:"add",color:"primary",label:"Agregar menor",onClick:u.addMenor},null,8,["onClick"])]),(p(!0),g(y,null,q(n.f.menores,(e,_)=>(p(),g("div",{key:_,class:"row q-col-gutter-sm items-end q-mb-sm"},[d("div",B,[l(a,{modelValue:e.nombre,"onUpdate:modelValue":s=>e.nombre=s,dense:"",outlined:"",label:"Nombres y apellidos"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",Y,[l(U,{modelValue:e.gestante,"onUpdate:modelValue":s=>e.gestante=s,label:"Gestante"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",Z,[l(a,{modelValue:e.edad_anios,"onUpdate:modelValue":s=>e.edad_anios=s,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",label:"Edad (años)"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",H,[l(a,{modelValue:e.edad_meses,"onUpdate:modelValue":s=>e.edad_meses=s,modelModifiers:{number:!0},dense:"",outlined:"",type:"number",label:"Edad (meses)"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",J,[l(V,{modelValue:e.sexo,"onUpdate:modelValue":s=>e.sexo=s,options:n.sexos,"emit-value":"","map-options":"",dense:"",outlined:"",label:"Sexo"},null,8,["modelValue","onUpdate:modelValue","options"])]),d("div",K,[l(U,{modelValue:e.cert_nac,"onUpdate:modelValue":s=>e.cert_nac=s,label:"C. Nac"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",W,[l(U,{modelValue:e.estudia,"onUpdate:modelValue":s=>e.estudia=s,label:"Estudia"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",X,[l(a,{modelValue:e.ultimo_curso,"onUpdate:modelValue":s=>e.ultimo_curso=s,dense:"",outlined:"",label:"Último curso"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",$,[l(a,{modelValue:e.tipo_trabajo,"onUpdate:modelValue":s=>e.tipo_trabajo=s,dense:"",outlined:"",label:"Tipo de trabajo"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",ee,[l(m,{icon:"delete",color:"negative",flat:"",dense:"",onClick:s=>n.f.menores.splice(_,1)},null,8,["onClick"])]),_<n.f.menores.length-1?(p(),v(b,{key:0,class:"q-my-sm"})):C("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(N,{icon:"diversity_3","dense-toggle":"","expand-separator":"",label:"3) Grupo familiar","header-class":"text-subtitle1"},{default:i(()=>[l(r,null,{default:i(()=>[l(t,null,{default:i(()=>[d("div",le,[l(m,{dense:"",icon:"add",color:"primary",label:"Agregar integrante",onClick:u.addFam},null,8,["onClick"])]),(p(!0),g(y,null,q(n.f.grupo_familiar,(e,_)=>(p(),g("div",{key:"g"+_,class:"row q-col-gutter-sm items-end q-mb-sm"},[d("div",oe,[l(a,{modelValue:e.nombre,"onUpdate:modelValue":s=>e.nombre=s,dense:"",outlined:"",label:"Nombres y apellidos"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",ne,[l(a,{modelValue:e.parentesco,"onUpdate:modelValue":s=>e.parentesco=s,dense:"",outlined:"",label:"Parentesco"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",de,[l(a,{modelValue:e.edad,"onUpdate:modelValue":s=>e.edad=s,modelModifiers:{number:!0},type:"number",dense:"",outlined:"",label:"Edad"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",ae,[l(V,{modelValue:e.sexo,"onUpdate:modelValue":s=>e.sexo=s,options:n.sexos,"emit-value":"","map-options":"",dense:"",outlined:"",label:"Sexo"},null,8,["modelValue","onUpdate:modelValue","options"])]),d("div",se,[l(a,{modelValue:e.instruccion,"onUpdate:modelValue":s=>e.instruccion=s,dense:"",outlined:"",label:"G. Instrucción"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",ie,[l(a,{modelValue:e.ocupacion,"onUpdate:modelValue":s=>e.ocupacion=s,dense:"",outlined:"",label:"Ocupación"},null,8,["modelValue","onUpdate:modelValue"])]),d("div",te,[l(m,{icon:"delete",color:"negative",flat:"",dense:"",onClick:s=>n.f.grupo_familiar.splice(_,1)},null,8,["onClick"])]),_<n.f.grupo_familiar.length-1?(p(),v(b,{key:0,class:"q-my-sm"})):C("",!0)]))),128))]),_:1})]),_:1})]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(t,{class:"row items-center"},{default:i(()=>[l(f,{name:"person_off",class:"q-mr-sm"}),o[28]||(o[28]=d("div",{class:"text-subtitle1 text-weight-medium"},"4) Datos del denunciado",-1))]),_:1}),l(b),l(t,null,{default:i(()=>[d("div",ue,[d("div",ce,[l(a,{modelValue:n.f.denunciado_nombre,"onUpdate:modelValue":o[6]||(o[6]=e=>n.f.denunciado_nombre=e),dense:"",outlined:"",clearable:"",label:"Nombre completo"},null,8,["modelValue"])]),d("div",re,[l(V,{modelValue:n.f.denunciado_sexo,"onUpdate:modelValue":o[7]||(o[7]=e=>n.f.denunciado_sexo=e),options:n.sexos,"emit-value":"","map-options":"",dense:"",outlined:"",label:"Sexo"},null,8,["modelValue","options"])]),d("div",me,[l(a,{modelValue:n.f.denunciado_edad,"onUpdate:modelValue":o[8]||(o[8]=e=>n.f.denunciado_edad=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",label:"Edad"},null,8,["modelValue"])]),d("div",_e,[l(a,{modelValue:n.f.denunciado_relacion,"onUpdate:modelValue":o[9]||(o[9]=e=>n.f.denunciado_relacion=e),dense:"",outlined:"",label:"Relación / tipo"},null,8,["modelValue"])]),d("div",pe,[l(a,{modelValue:n.f.denunciado_ci,"onUpdate:modelValue":o[10]||(o[10]=e=>n.f.denunciado_ci=e),dense:"",outlined:"",clearable:"",label:"C.I."},null,8,["modelValue"])]),d("div",be,[l(a,{modelValue:n.f.denunciado_domicilio,"onUpdate:modelValue":o[11]||(o[11]=e=>n.f.denunciado_domicilio=e),dense:"",outlined:"",clearable:"",label:"Domicilio"},null,8,["modelValue"])]),d("div",fe,[l(a,{modelValue:n.f.denunciado_telefono,"onUpdate:modelValue":o[12]||(o[12]=e=>n.f.denunciado_telefono=e),dense:"",outlined:"",clearable:"",label:"Teléfono"},null,8,["modelValue"])]),d("div",Ve,[l(a,{modelValue:n.f.denunciado_lugar_trabajo,"onUpdate:modelValue":o[13]||(o[13]=e=>n.f.denunciado_lugar_trabajo=e),dense:"",outlined:"",clearable:"",label:"Lugar de trabajo"},null,8,["modelValue"])]),d("div",ge,[l(a,{modelValue:n.f.denunciado_ocupacion,"onUpdate:modelValue":o[14]||(o[14]=e=>n.f.denunciado_ocupacion=e),dense:"",outlined:"",clearable:"",label:"Ocupación"},null,8,["modelValue"])])])]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(t,{class:"row items-center"},{default:i(()=>[l(f,{name:"person",class:"q-mr-sm"}),o[29]||(o[29]=d("div",{class:"text-subtitle1 text-weight-medium"},"5) Datos del denunciante",-1))]),_:1}),l(b),l(t,null,{default:i(()=>[d("div",ve,[d("div",xe,[l(a,{modelValue:n.f.denunciante_nombre,"onUpdate:modelValue":o[15]||(o[15]=e=>n.f.denunciante_nombre=e),dense:"",outlined:"",clearable:"",label:"Nombre completo *",rules:[u.req]},null,8,["modelValue","rules"])]),d("div",Ue,[l(V,{modelValue:n.f.denunciante_sexo,"onUpdate:modelValue":o[16]||(o[16]=e=>n.f.denunciante_sexo=e),options:n.sexos,"emit-value":"","map-options":"",dense:"",outlined:"",label:"Sexo"},null,8,["modelValue","options"])]),d("div",he,[l(a,{modelValue:n.f.denunciante_edad,"onUpdate:modelValue":o[17]||(o[17]=e=>n.f.denunciante_edad=e),modelModifiers:{number:!0},type:"number",dense:"",outlined:"",label:"Edad"},null,8,["modelValue"])]),d("div",ye,[l(a,{modelValue:n.f.denunciante_ci,"onUpdate:modelValue":o[18]||(o[18]=e=>n.f.denunciante_ci=e),dense:"",outlined:"",clearable:"",label:"C.I."},null,8,["modelValue"])]),d("div",qe,[l(a,{modelValue:n.f.denunciante_domicilio,"onUpdate:modelValue":o[19]||(o[19]=e=>n.f.denunciante_domicilio=e),dense:"",outlined:"",clearable:"",label:"Domicilio"},null,8,["modelValue"])]),d("div",Ce,[l(a,{modelValue:n.f.denunciante_telefono,"onUpdate:modelValue":o[20]||(o[20]=e=>n.f.denunciante_telefono=e),dense:"",outlined:"",clearable:"",label:"Teléfono"},null,8,["modelValue"])]),d("div",Ne,[l(a,{modelValue:n.f.denunciante_lugar_trabajo,"onUpdate:modelValue":o[21]||(o[21]=e=>n.f.denunciante_lugar_trabajo=e),dense:"",outlined:"",clearable:"",label:"Lugar de trabajo"},null,8,["modelValue"])]),d("div",we,[l(a,{modelValue:n.f.denunciante_ocupacion,"onUpdate:modelValue":o[22]||(o[22]=e=>n.f.denunciante_ocupacion=e),dense:"",outlined:"",clearable:"",label:"Ocupación"},null,8,["modelValue"])])])]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card"},{default:i(()=>[l(t,{class:"row items-center"},{default:i(()=>[l(f,{name:"description",class:"q-mr-sm"}),o[30]||(o[30]=d("div",{class:"text-subtitle1 text-weight-medium"},"6) Descripción de la denuncia",-1))]),_:1}),l(b),l(t,null,{default:i(()=>[l(a,{modelValue:n.f.descripcion,"onUpdate:modelValue":o[23]||(o[23]=e=>n.f.descripcion=e),type:"textarea",autogrow:"",outlined:"",dense:"",clearable:"",label:"Descripción",maxlength:"5000",counter:""},null,8,["modelValue"])]),_:1})]),_:1}),l(r,{flat:"",bordered:"",class:"section-card q-mb-xl"},{default:i(()=>[l(t,{class:"row items-center"},{default:i(()=>[l(f,{name:"group",class:"q-mr-sm"}),o[31]||(o[31]=d("div",{class:"text-subtitle1 text-weight-medium"},"7) Asignación",-1))]),_:1}),l(b),l(t,null,{default:i(()=>[d("div",Ae,[d("div",ke,[l(V,{modelValue:n.f.abogado_user_id,"onUpdate:modelValue":o[24]||(o[24]=e=>n.f.abogado_user_id=e),dense:"",outlined:"","emit-value":"","map-options":"",clearable:"",options:n.abogados.map(e=>({label:e.name,value:e.id})),label:"Abogado/a asignado"},null,8,["modelValue","options"])]),d("div",Pe,[l(h,{outline:"",color:"grey-6","text-color":"grey-10"},{default:i(()=>o[32]||(o[32]=[x("Área: DNA")])),_:1})])])]),_:1})]),_:1}),d("div",De,[l(m,{flat:"",color:"primary",icon:"history",label:"Limpiar",onClick:u.resetForm,class:"q-mr-sm"},null,8,["onClick"]),l(m,{color:"primary",icon:"save",label:"Guardar",loading:n.loading,onClick:u.save},null,8,["loading","onClick"])])]),_:1},8,["onSubmit"])]),_:1})}const Re=w(j,[["render",je],["__scopeId","data-v-fa09c263"]]);export{Re as D};
